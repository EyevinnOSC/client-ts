/**
 * This file was auto-generated by openapi-typescript.
 * Do not make direct changes to the file.
 */

export interface paths {
  '/': {
    /** Health check endpoint */
    get: {
      parameters: {
        query: {
          verbose?: boolean;
        };
      };
      responses: {
        /** Default Response */
        200: {
          schema: Partial<string> &
            Partial<{
              status: string;
              versions: {
                '@osaas/orchestrator': string;
              };
              environment: string;
              _links: {
                self: {
                  href: string;
                };
                api: {
                  href: string;
                };
              };
            }>;
        };
        /** Default Response */
        500: {
          schema: {
            status: string;
            reason: string;
          };
        };
      };
    };
  };
  '/airflowinstance': {
    /** List all running airflow instances */
    get: {
      responses: {
        /** Default Response */
        200: {
          schema: ({
            /** @description Name of the airflow instance */
            name: string;
            /** @description URL to instance API */
            url: string;
            resources: {
              license: {
                /** @description URL to license information */
                url: string;
              };
              apiDocs?: {
                /** @description URL to instance API documentation */
                url: string;
              };
              app?: {
                /** @description URL to instance application (GUI) */
                url: string;
              };
            };
            AdminPassword?: string;
            DatabaseUrl?: string;
          } & {
            _links: {
              self: {
                /** @description Instance resource */
                href: string;
              };
              logs?: {
                /** @description Get logs for this instance */
                href: string;
              };
              health?: {
                /** @description Get health status for this instance */
                href: string;
              };
              ports?: {
                /** @description Get exposed ports for this instance */
                href: string;
              };
              restart?: {
                /** @description Restart this instance */
                href: string;
              };
              update?: {
                /** @description Update this instance */
                href: string;
              };
              scale?: {
                /** @description Scale this instance */
                href: string;
              };
            };
          })[];
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
    /** Launch a new airflow instance */
    post: {
      parameters: {
        query: {
          beta?: boolean;
        };
        body: {
          body?: {
            /** @description Name of the airflow instance */
            name: string;
            AdminPassword?: string;
            DatabaseUrl?: string;
          };
        };
      };
      responses: {
        /** Default Response */
        200: {
          schema: {
            /** @description Name of the airflow instance */
            name: string;
            /** @description URL to instance API */
            url: string;
            resources: {
              license: {
                /** @description URL to license information */
                url: string;
              };
              apiDocs?: {
                /** @description URL to instance API documentation */
                url: string;
              };
              app?: {
                /** @description URL to instance application (GUI) */
                url: string;
              };
            };
            AdminPassword?: string;
            DatabaseUrl?: string;
          } & {
            _links: {
              self: {
                /** @description Instance resource */
                href: string;
              };
              logs?: {
                /** @description Get logs for this instance */
                href: string;
              };
              health?: {
                /** @description Get health status for this instance */
                href: string;
              };
              ports?: {
                /** @description Get exposed ports for this instance */
                href: string;
              };
              restart?: {
                /** @description Restart this instance */
                href: string;
              };
              update?: {
                /** @description Update this instance */
                href: string;
              };
              scale?: {
                /** @description Scale this instance */
                href: string;
              };
            };
          };
        };
        /** Default Response */
        403: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
        /** Default Response */
        409: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
  };
  '/restart/{id}': {
    /** Restart airflow */
    post: {
      parameters: {
        path: {
          /** Name of the airflow instance */
          id: string;
        };
      };
      responses: {
        /** Default Response */
        204: {
          schema: string;
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
  };
  '/airflowinstance/{id}': {
    /** Obtain status and resource URLs for an airflow instance */
    get: {
      parameters: {
        path: {
          /** Name of the airflow instance */
          id: string;
        };
      };
      responses: {
        /** Default Response */
        200: {
          schema: {
            /** @description Name of the airflow instance */
            name: string;
            /** @description URL to instance API */
            url: string;
            resources: {
              license: {
                /** @description URL to license information */
                url: string;
              };
              apiDocs?: {
                /** @description URL to instance API documentation */
                url: string;
              };
              app?: {
                /** @description URL to instance application (GUI) */
                url: string;
              };
            };
            AdminPassword?: string;
            DatabaseUrl?: string;
          } & {
            _links: {
              self: {
                /** @description Instance resource */
                href: string;
              };
              logs?: {
                /** @description Get logs for this instance */
                href: string;
              };
              health?: {
                /** @description Get health status for this instance */
                href: string;
              };
              ports?: {
                /** @description Get exposed ports for this instance */
                href: string;
              };
              restart?: {
                /** @description Restart this instance */
                href: string;
              };
              update?: {
                /** @description Update this instance */
                href: string;
              };
              scale?: {
                /** @description Scale this instance */
                href: string;
              };
            };
          };
        };
        /** Default Response */
        404: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
    /** Stop and remove an airflow instance */
    delete: {
      parameters: {
        path: {
          /** Name of the airflow instance */
          id: string;
        };
      };
      responses: {
        /** Default Response */
        204: {
          schema: string;
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
    /** Patch airflow instance with new parameters and restart */
    patch: {
      parameters: {
        body: {
          body?: {
            /** @description Name of the airflow instance */
            name?: string;
            AdminPassword?: string;
            DatabaseUrl?: string;
          };
        };
        path: {
          /** Name of the airflow instance */
          id: string;
        };
      };
      responses: {
        /** Default Response */
        200: {
          schema: {
            /** @description Name of the airflow instance */
            name: string;
            /** @description URL to instance API */
            url: string;
            resources: {
              license: {
                /** @description URL to license information */
                url: string;
              };
              apiDocs?: {
                /** @description URL to instance API documentation */
                url: string;
              };
              app?: {
                /** @description URL to instance application (GUI) */
                url: string;
              };
            };
            AdminPassword?: string;
            DatabaseUrl?: string;
          } & {
            _links: {
              self: {
                /** @description Instance resource */
                href: string;
              };
              logs?: {
                /** @description Get logs for this instance */
                href: string;
              };
              health?: {
                /** @description Get health status for this instance */
                href: string;
              };
              ports?: {
                /** @description Get exposed ports for this instance */
                href: string;
              };
              restart?: {
                /** @description Restart this instance */
                href: string;
              };
              update?: {
                /** @description Update this instance */
                href: string;
              };
              scale?: {
                /** @description Scale this instance */
                href: string;
              };
            };
          };
        };
        /** Default Response */
        400: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
        /** Default Response */
        404: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
  };
  '/health/{id}': {
    /** Return status of airflow instance */
    get: {
      parameters: {
        path: {
          /** Name of the airflow instance */
          id: string;
        };
      };
      responses: {
        /** Default Response */
        200: {
          schema: {
            /** @enum {string} */
            status: 'starting' | 'running' | 'stopped' | 'failed' | 'unknown';
            images?: string[];
          };
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
  };
  '/logs/{id}': {
    /** Return the latest logs from the airflow instance */
    get: {
      parameters: {
        query: {
          timestamps?: boolean;
          sinceSeconds?: number;
        };
        path: {
          /** Name of the airflow instance */
          id: string;
        };
      };
      responses: {
        /** Default Response */
        200: {
          schema: string;
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
  };
  '/ports/{id}': {
    /** Return the exposed extra ports for airflow instance */
    get: {
      parameters: {
        path: {
          /** Name of the airflow instance */
          id: string;
        };
      };
      responses: {
        /** Default Response */
        200: {
          schema: {
            externalIp: string;
            externalPort: number;
            internalPort: number;
          }[];
        };
        /** Default Response */
        500: {
          schema: {
            /** @description Reason why something failed */
            reason: string;
          };
        };
      };
    };
  };
}

export interface definitions {}

export interface operations {}

export interface external {}

export type ApacheAirflow =
  paths['/airflowinstance/{id}']['get']['responses']['200']['schema'];

export type ApacheAirflowConfig =
  paths['/airflowinstance']['post']['parameters']['body']['body'];
import {
  Context,
  createInstance,
  waitForInstanceReady,
  removeInstance,
  getInstance
} from '@osaas/client-core';
/**
 * @namespace apache-airflow
 * @description Discover Apache Airflow, the ultimate platform for programmatically authoring, scheduling, and monitoring workflows. Transform complex tasks into manageable, streamlined operations with dynamic and extensible DAGs. Enhance your workflow efficiency today!
 * @author Eyevinn Technology AB <osc@eyevinn.se>
 * @copyright 2026 Eyevinn Technology AB
 *
 */

/**
 * @typedef {Object} ApacheAirflowConfig
 * @property {string} name - Name of airflow
 * @property {string} [AdminPassword] - Password for the administrative user account in Apache Airflow. This is typically used to access the web UI and perform administrative operations.
 * @property {string} [DatabaseUrl] - Connection string for the metadata database that Airflow uses to store DAG information, task states, and other operational data. Supports PostgreSQL, MySQL, and SQLite databases.

 * 
 */

/**
 * @typedef {Object} ApacheAirflow
 * @property {string} name - Name of the Airflow instance
 * @property {string} url - URL of the Airflow instance
 *
 */

/**
 * Create a new Airflow instance
 *
 * @memberOf apache-airflow
 * @async
 * @param {Context} context - Open Source Cloud configuration context
 * @param {ApacheAirflowConfig} body - Service instance configuration
 * @returns {ApacheAirflow} - Service instance
 * @example
 * import { Context } from '@osaas/client-core';
 * import { createApacheAirflowInstance } from '@osaas/client-services';
 *
 * const ctx = new Context();
 * const body: ApacheAirflowConfig = { name: 'myinstance', ... };
 * const instance = await createApacheAirflowInstance(ctx, body);
 * console.log(instance.url);
 */
export async function createApacheAirflowInstance(
  ctx: Context,
  body: ApacheAirflowConfig
): Promise<ApacheAirflow> {
  const serviceAccessToken = await ctx.getServiceAccessToken('apache-airflow');
  const instance = await createInstance(
    ctx,
    'apache-airflow',
    serviceAccessToken,
    body
  );
  await waitForInstanceReady('apache-airflow', instance.name, ctx);
  return instance;
}

/**
 * Remove a Airflow instance
 *
 * @memberOf apache-airflow
 * @async
 * @param {Context} context - Open Source Cloud configuration context
 * @param {string} name - Name of the airflow to be removed
 */
export async function removeApacheAirflowInstance(
  ctx: Context,
  name: string
): Promise<void> {
  const serviceAccessToken = await ctx.getServiceAccessToken('apache-airflow');
  await removeInstance(ctx, 'apache-airflow', name, serviceAccessToken);
}

/**
 * Get a Airflow instance
 *
 * @memberOf apache-airflow
 * @async
 * @param {Context} context - Open Source Cloud configuration context
 * @param {string} name - Name of the airflow to be retrieved
 * @returns {ApacheAirflow} - Service instance
 * @example
 * import { Context } from '@osaas/client-core';
 * import { getApacheAirflowInstance } from '@osaas/client-services';
 *
 * const ctx = new Context();
 * const instance = await getApacheAirflowInstance(ctx, 'myinstance');
 * console.log(instance.url);
 */
export async function getApacheAirflowInstance(
  ctx: Context,
  name: string
): Promise<ApacheAirflow> {
  const serviceAccessToken = await ctx.getServiceAccessToken('apache-airflow');
  return await getInstance(ctx, 'apache-airflow', name, serviceAccessToken);
}
